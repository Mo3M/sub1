mixed-port: 7890
socks-port: 7891
allow-lan: true
bind-address: "*"
ipv6: true
mode: rule
log-level: info
external-controller: '127.0.0.1:9090'
global-client-fingerprint: chrome #3m

enable-process: true # 3M
find-process-mode: strict

tun:
  enable: true
  stack: mixed
  dns-hijack: [any:53]

keep-alive-interval: 15
keep-alive-idle: 15
disable-keep-alive: false
unified-delay: true

sniffer:
  enable: true #false
  force-dns-mapping: true
  parse-pure-ip: true
  override-destination: false
  sniff:
    HTTP:
      ports: [80, 8080-8880]
      override-destination: true
    TLS:
      ports: [443, 8443]
    QUIC:
      ports: [443, 8443]

dns:
  enabled: true

  prefer-h3: false
  respect-rules: true
  
  ipv6: false #3m changed it
  listen: 0.0.0.0:53
  enhanced-mode: redir-host #fake-ip # Mode: redir-host or fake-ip # disabled again by 3M

  default-nameserver:
    - 9.9.9.9
    - 223.5.5.5

  nameserver:
    - 9.9.9.9 # added by 3M
    - http://9.9.9.9
    - https://doh.sandbox.opendns.com/dns-query
    - https://doh.opendns.com/dns-query
    - https://dns.alidns.com/dns-query
    
    - 208.67.222.222 # added by 3M

    - tls://8.26.56.26 # added by 3M
    - udp://8.26.56.26 # added by 3M
    - 119.29.29.29
    - 223.5.5.5
    - https://dns.google/dns-query # added by 3M
    - https://dns.cloudflare.com/dns-query # added by 3M
  proxy-server-nameserver:
    - https://223.5.5.5/dns-query
    - tls://223.5.5.5
  fallback:
    - https://doh.sandbox.opendns.com/dns-query
    - 8.8.8.8
    - 8.8.4.4
    - 1.1.1.1
    - tls://1.0.0.1:853
    - tls://dns.google:853

cfw-latency-timeout: 3000
cfw-latency-url: http://www.gstatic.com/generate_204
cfw-conn-break-strategy:
  proxy: none # none/chain/all
  profile: true # true/false
  mode: false # true/false
cfw-proxies-order: default
Proxy: ~
proxy: ~
proxies: ~

rule-providers:
  reject:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/reject.txt"
    path: ./ruleset/reject.yaml
    interval: 86400
  iran_other_sites:
    type: http
    format: text
    behavior: domain
    url: "https://github.com/bootmortis/iran-hosted-domains/releases/latest/download/clash_rules_other.txt"
    path: ./ruleset/iran_other.txt
    interval: 432000
  iran_ads:
    type: http
    format: text
    behavior: domain
    url: "https://github.com/bootmortis/iran-hosted-domains/releases/latest/download/clash_rules_ads.txt"
    path: ./ruleset/iran_ads.txt
    interval: 432000
  BanAD:
    type: http
    format: text
    behavior: classical
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/BanAD.list
    path: ./ruleset/BanAD.list
    interval: 432000
  BanProgramAD:
    type: http
    format: text
    behavior: classical
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/BanProgramAD.list
    path: ./ruleset/BanProgramAD.list
    interval: 432000
  Adobe:
    type: http
    format: text
    behavior: classical
    url: https://raw.githubusercontent.com/cmliu/ACL4SSR/main/Clash/adobe.list
    path: ./ruleset/adobe.list
    interval: 432000
  GoogleFCM:
    type: http
    format: text
    behavior: classical
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Ruleset/GoogleFCM.list
    path: ./ruleset/GoogleFCM.list
    interval: 432000
  Microsoft-Services:
    type: http
    format: text
    behavior: classical
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Microsoft.list
    path: ./ruleset/MS-Services.list
    interval: 432000
  Microsoft-Bing:
    type: http
    format: text
    behavior: classical
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Bing.list
    path: ./ruleset/MS-Bing.list
    interval: 432000    
  Microsoft-OneDrive:
    type: http
    format: text
    behavior: classical
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/OneDrive.list
    path: ./ruleset/MS-OneDrive.list
  Apple:
    type: http
    format: text
    behavior: classical
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Apple.list
    path: ./ruleset/Apple.list
    interval: 432000
  TG:
    type: http
    format: text
    behavior: classical
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Telegram.list
    path: ./ruleset/Telegram.list
    interval: 432000    
  OpenAI:
    type: http
    format: text
    behavior: classical
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Ruleset/OpenAi.list
    path: ./ruleset/OpenAi.list
    interval: 432000
  AI:
    type: http
    format: text
    behavior: classical
    url: https://raw.githubusercontent.com/juewuy/ShellClash/master/rules/ai.list
    path: ./ruleset/ai.list
    interval: 432000

  Copilot:
    type: http
    format: text
    behavior: classical
    url: https://raw.githubusercontent.com/cmliu/ACL4SSR/refs/heads/main/Clash/Copilot.list
    path: ./ruleset/Copilot.list
    interval: 432000


  GithubCopilot:
    type: http
    format: text
    behavior: classical
    url: https://raw.githubusercontent.com/cmliu/ACL4SSR/refs/heads/main/Clash/GithubCopilot.list
    path: ./ruleset/GithubCopilot.list
    interval: 432000
  Claude:
    type: http
    format: text
    behavior: classical
    url:  https://raw.githubusercontent.com/cmliu/ACL4SSR/refs/heads/main/Clash/Claude.list
    path: ./ruleset/Claude.list 
    interval: 432000
  Gemini:
    type: http
    format: text
    behavior: classical
    url:  https://raw.githubusercontent.com/cmliu/ACL4SSR/refs/heads/main/Clash/Gemini.list
    path: ./ruleset/Gemini.list 
    interval: 432000  
  YT:
    type: http
    format: text
    behavior: classical
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Ruleset/YouTube.list
    path: ./ruleset/YouTube.list
    interval: 432000
  NetFlix:
    type: http
    format: text
    behavior: classical
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Ruleset/Netflix.list
    path: ./ruleset/Netflix.list
    interval: 432000  
  Foreign-Media:
    type: http
    format: text
    behavior: classical
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/ProxyMedia.list
    path: ./ruleset/Foreign-Media.list
    interval: 432000
  CF-CIDR:
    type: http
    format: text
    behavior: classical
    url: https://raw.githubusercontent.com/cmliu/ACL4SSR/main/Clash/CloudflareCIDR.list
    path: ./ruleset/CloudflareCIDR.list
    interval: 432000    
  NetEaseMusic:
    type: http
    format: text
    behavior: classical
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Ruleset/NetEaseMusic.list
    path: ./ruleset/NetEaseMusic.list
    interval: 432000
  Game-Epic:
    type: http
    format: text
    behavior: classical
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Ruleset/Epic.list
    path: ./ruleset/Game-Epic.list
    interval: 432000
  Game-Nintendo:
    type: http
    format: text
    behavior: classical
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Ruleset/Nintendo.list
    path: ./ruleset/Game-Nintendo.list
    interval: 432000
  Game-Origin:
    type: http
    format: text
    behavior: classical
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Ruleset/Origin.list
    path: ./ruleset/Game-Origin.list
    interval: 432000  
  Game-Sony:
    type: http
    format: text
    behavior: classical
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Ruleset/Sony.list
    path: ./ruleset/Game-Sony.list
    interval: 432000  
  oisd_big:
    type: http
    behavior: classical
    path: "./rule_provider/oisd_big.yaml"
    url: https://raw.githubusercontent.com/hillz2/openclash_adblock/main/oisd_big.yaml
    interval: 28800 # Update rules every 8 hours


rules:

  - RULE-SET,oisd_big,üõë Global Block
  - RULE-SET, reject, üõë Global Block

  
  - RULE-SET,iran_ads, üõë Global Block
  
  - RULE-SET,BanAD, üõë Global Block
  - RULE-SET,BanProgramAD,üçÉ Application Ban
  - RULE-SET,Adobe,üçÉ Application Ban
  - RULE-SET,GoogleFCM,üì¢ Google FCM
  - RULE-SET, Microsoft-Services,‚ìÇÔ∏è MS Services
  - RULE-SET, Microsoft-Bing,‚ìÇÔ∏è MS Bing
  - RULE-SET, Microsoft-OneDrive,‚ìÇÔ∏è MS OneDrive
  - RULE-SET,Apple, üçé Apple Services
  - RULE-SET,TG,üì≤ Telegram

  - RUlE-SET,OpenAI, ü§ñ OpenAI
  - RUlE-SET,AI, ü§ñ OpenAI
  - RUlE-SET,Claude, ü§ñ OpenAI
  - RUlE-SET,Gemini, ü§ñ OpenAI
  - RUlE-SET,GithubCopilot, ü§ñ OpenAI
  - RUlE-SET,Copilot, ü§ñ OpenAI

  - RULE-SET,YT,üìπ YouTube
  - RULE-SET,NetFlix,üé• Netflix
  - RULE-SET,Foreign-Media,üåç Foreign Media

  - RULE-SET, CF-CIDR,‚òÅÔ∏è CloudFlareCDN
  - RULE-SET, NetEaseMusic,üé∂ NetEase Music
  - RULE-SET, Game-Epic, üéÆ Game Platforms
  - RULE-SET, Game-Nintendo, üéÆ Game Platforms
  - RULE-SET, Game-Origin, üéÆ Game Platforms
  - RULE-SET, Game-Sony, üéÆ Game Platforms
  

  - GEOIP,LAN, üéØ Global Direct
  - GEOIP,IR, üéØ Global Direct
  - DOMAIN-SUFFIX,ir, üéØ Global Direct
  - RULE-SET,iran_other_sites, üéØ Global Direct
  - MATCH,üêü Free Fish
